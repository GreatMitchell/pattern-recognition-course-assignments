Using device: cuda
Loaded checkpoint from epoch 21
Epoch 22/50 | Time 361.7s | Train loss 0.4382 acc 0.9635 | Val loss 0.5184 acc 0.9367
Epoch 23/50 | Time 358.4s | Train loss 0.4417 acc 0.9573 | Val loss 0.5105 acc 0.9445
Epoch 24/50 | Time 359.8s | Train loss 0.4248 acc 0.9563 | Val loss 0.4991 acc 0.9367
Epoch 25/50 | Time 358.4s | Train loss 0.4117 acc 0.9661 | Val loss 0.4893 acc 0.9445
Epoch 26/50 | Time 358.8s | Train loss 0.4024 acc 0.9661 | Val loss 0.4797 acc 0.9445
Epoch 27/50 | Time 356.5s | Train loss 0.3985 acc 0.9661 | Val loss 0.4701 acc 0.9445
Epoch 28/50 | Time 355.6s | Train loss 0.3824 acc 0.9599 | Val loss 0.4638 acc 0.9445
Epoch 29/50 | Time 358.5s | Train loss 0.3779 acc 0.9667 | Val loss 0.4611 acc 0.9445
Epoch 30/50 | Time 357.5s | Train loss 0.3877 acc 0.9661 | Val loss 0.4588 acc 0.9445
Epoch 31/50 | Time 360.8s | Train loss 0.3786 acc 0.9599 | Val loss 0.4548 acc 0.9445
Epoch 32/50 | Time 364.7s | Train loss 0.3793 acc 0.9651 | Val loss 0.4531 acc 0.9445
Epoch 33/50 | Time 367.5s | Train loss 0.3622 acc 0.9625 | Val loss 0.4481 acc 0.9445
Epoch 34/50 | Time 366.3s | Train loss 0.3806 acc 0.9635 | Val loss 0.4447 acc 0.9445
Epoch 35/50 | Time 361.0s | Train loss 0.3739 acc 0.9615 | Val loss 0.4419 acc 0.9445
Epoch 36/50 | Time 359.9s | Train loss 0.3535 acc 0.9693 | Val loss 0.4400 acc 0.9445
Epoch 37/50 | Time 359.7s | Train loss 0.3727 acc 0.9667 | Val loss 0.4354 acc 0.9445
Epoch 38/50 | Time 364.2s | Train loss 0.3464 acc 0.9714 | Val loss 0.4356 acc 0.9445
Epoch 39/50 | Time 366.6s | Train loss 0.3538 acc 0.9740 | Val loss 0.4327 acc 0.9445
Epoch 40/50 | Time 366.3s | Train loss 0.3461 acc 0.9688 | Val loss 0.4310 acc 0.9445
Epoch 41/50 | Time 360.7s | Train loss 0.3517 acc 0.9651 | Val loss 0.4298 acc 0.9445
Epoch 42/50 | Time 362.8s | Train loss 0.3653 acc 0.9641 | Val loss 0.4260 acc 0.9445
Epoch 43/50 | Time 361.1s | Train loss 0.3494 acc 0.9693 | Val loss 0.4270 acc 0.9445
Epoch 44/50 | Time 365.3s | Train loss 0.3378 acc 0.9714 | Val loss 0.4241 acc 0.9445
Epoch 45/50 | Time 362.8s | Train loss 0.3683 acc 0.9657 | Val loss 0.4245 acc 0.9445
Epoch 46/50 | Time 366.4s | Train loss 0.3430 acc 0.9693 | Val loss 0.4237 acc 0.9445
Epoch 47/50 | Time 365.3s | Train loss 0.3569 acc 0.9641 | Val loss 0.4260 acc 0.9445
Epoch 48/50 | Time 368.5s | Train loss 0.3640 acc 0.9615 | Val loss 0.4217 acc 0.9445
Epoch 49/50 | Time 368.5s | Train loss 0.3440 acc 0.9729 | Val loss 0.4222 acc 0.9445
Epoch 50/50 | Time 364.3s | Train loss 0.3400 acc 0.9677 | Val loss 0.4229 acc 0.9445
Resume training finished. Best val acc: 0.9445043057203293

Using device: cuda
Loaded checkpoint from epoch 20
Epoch 21/30 | Time 363.1s | Train loss 0.4621 acc 0.9583 | Val loss 0.5339 acc 0.9445
Epoch 22/30 | Time 361.1s | Train loss 0.4321 acc 0.9661 | Val loss 0.5119 acc 0.9367
Epoch 23/30 | Time 360.6s | Train loss 0.4320 acc 0.9599 | Val loss 0.4888 acc 0.9445
Epoch 24/30 | Time 364.6s | Train loss 0.4146 acc 0.9667 | Val loss 0.4753 acc 0.9445
Epoch 25/30 | Time 361.1s | Train loss 0.3971 acc 0.9661 | Val loss 0.4617 acc 0.9367
Epoch 26/30 | Time 369.6s | Train loss 0.3752 acc 0.9714 | Val loss 0.4440 acc 0.9445
Epoch 27/30 | Time 360.7s | Train loss 0.3796 acc 0.9625 | Val loss 0.4274 acc 0.9445
Epoch 28/30 | Time 360.8s | Train loss 0.3701 acc 0.9625 | Val loss 0.4273 acc 0.9445
Epoch 29/30 | Time 360.8s | Train loss 0.3506 acc 0.9703 | Val loss 0.4255 acc 0.9445
Epoch 30/30 | Time 359.5s | Train loss 0.3385 acc 0.9688 | Val loss 0.4220 acc 0.9445
Resume training finished. Best val acc: 0.9445043057203293

Using device: cuda
Loaded checkpoint from epoch 20
Warning: Optimizer state has different number of parameter groups (likely due to unfreezing backbone). Skipping optimizer state loading.
Using device: cuda
Loaded checkpoint from epoch 20
Warning: Optimizer state has different number of parameter groups (likely due to unfreezing backbone). Skipping optimizer state loading.
Epoch 21/30 | Time 195.2s | Train loss 0.5043 acc 0.9407 | Val loss 0.4707 acc 0.9523
Epoch 22/30 | Time 184.7s | Train loss 0.3825 acc 0.9635 | Val loss 0.4163 acc 0.9445
Epoch 23/30 | Time 183.7s | Train loss 0.3338 acc 0.9755 | Val loss 0.3581 acc 0.9523
Epoch 24/30 | Time 182.2s | Train loss 0.2857 acc 0.9792 | Val loss 0.3173 acc 0.9601
Epoch 25/30 | Time 181.2s | Train loss 0.2391 acc 0.9834 | Val loss 0.2910 acc 0.9601
Epoch 26/30 | Time 181.9s | Train loss 0.2226 acc 0.9844 | Val loss 0.2668 acc 0.9523
Epoch 27/30 | Time 182.3s | Train loss 0.1972 acc 0.9870 | Val loss 0.2462 acc 0.9445
Epoch 28/30 | Time 181.2s | Train loss 0.1717 acc 0.9870 | Val loss 0.2260 acc 0.9523
Epoch 29/30 | Time 182.6s | Train loss 0.1644 acc 0.9912 | Val loss 0.2139 acc 0.9601
Epoch 30/30 | Time 182.8s | Train loss 0.1575 acc 0.9922 | Val loss 0.2022 acc 0.9601
Resume training finished. Best val acc: 0.9601293057203293

Using device: cuda
Loaded checkpoint from epoch 24
Optimizer state loaded successfully.
Epoch 25/40 | Time 188.2s | Train loss 0.2699 acc 0.9746
Epoch 26/40 | Time 186.9s | Train loss 0.2392 acc 0.9766
Epoch 27/40 | Time 185.8s | Train loss 0.2053 acc 0.9852
Epoch 28/40 | Time 185.3s | Train loss 0.1620 acc 0.9863
Epoch 29/40 | Time 184.5s | Train loss 0.1460 acc 0.9902
Epoch 30/40 | Time 184.5s | Train loss 0.1417 acc 0.9879
Epoch 31/40 | Time 184.9s | Train loss 0.1261 acc 0.9902
Epoch 32/40 | Time 184.2s | Train loss 0.1179 acc 0.9922
Epoch 33/40 | Time 182.4s | Train loss 0.1128 acc 0.9961
Epoch 34/40 | Time 182.3s | Train loss 0.1069 acc 0.9898
Epoch 35/40 | Time 183.3s | Train loss 0.0978 acc 0.9961
Epoch 36/40 | Time 183.1s | Train loss 0.0961 acc 0.9949
Epoch 37/40 | Time 182.9s | Train loss 0.0887 acc 1.0000
Epoch 38/40 | Time 183.1s | Train loss 0.0849 acc 0.9980
Epoch 39/40 | Time 183.2s | Train loss 0.0862 acc 0.9949
Epoch 40/40 | Time 184.6s | Train loss 0.0816 acc 1.0000
Resume training finished. Best train loss: 0.08161398093216121

Using device: cuda
Loading ResNet weights from checkpoints_batchsize32_and_no_reg/resnet18_finetune/train_full/best.pth
Custom ResNet weights loaded successfully.
Epoch 1/40 | Time 184.8s | Train loss 2.9329 acc 0.1051 | Val loss 2.9631 acc 0.1767
Epoch 2/40 | Time 181.8s | Train loss 2.7899 acc 0.4321 | Val loss 2.9047 acc 0.2002
Epoch 3/40 | Time 179.9s | Train loss 2.5914 acc 0.5508 | Val loss 2.7892 acc 0.2939
Epoch 4/40 | Time 180.6s | Train loss 2.3104 acc 0.6846 | Val loss 2.6068 acc 0.4582
Epoch 5/40 | Time 180.4s | Train loss 1.9912 acc 0.7090 | Val loss 2.3065 acc 0.5294
Epoch 6/40 | Time 180.7s | Train loss 1.6336 acc 0.7585 | Val loss 1.9311 acc 0.5450
Epoch 7/40 | Time 179.9s | Train loss 1.3386 acc 0.8236 | Val loss 1.5493 acc 0.6880
Epoch 8/40 | Time 180.4s | Train loss 1.1064 acc 0.8850 | Val loss 1.3224 acc 0.7772
Epoch 9/40 | Time 180.3s | Train loss 0.9773 acc 0.9048 | Val loss 1.1123 acc 0.8405
Epoch 10/40 | Time 181.4s | Train loss 0.8891 acc 0.9136 | Val loss 0.9198 acc 0.8882
Epoch 11/40 | Time 180.2s | Train loss 0.7856 acc 0.9365 | Val loss 0.8127 acc 0.8882
Epoch 12/40 | Time 181.0s | Train loss 0.7065 acc 0.9443 | Val loss 0.7483 acc 0.9116
Epoch 13/40 | Time 181.9s | Train loss 0.6280 acc 0.9531 | Val loss 0.6815 acc 0.9203
Epoch 14/40 | Time 182.1s | Train loss 0.5592 acc 0.9677 | Val loss 0.6215 acc 0.9359
Epoch 15/40 | Time 181.3s | Train loss 0.5195 acc 0.9688 | Val loss 0.5948 acc 0.9281
Epoch 16/40 | Time 181.9s | Train loss 0.4762 acc 0.9818 | Val loss 0.5685 acc 0.9515
Epoch 17/40 | Time 180.7s | Train loss 0.4509 acc 0.9870 | Val loss 0.5409 acc 0.9515
Epoch 18/40 | Time 181.0s | Train loss 0.4261 acc 0.9844 | Val loss 0.5210 acc 0.9437
Epoch 19/40 | Time 181.9s | Train loss 0.4039 acc 0.9896 | Val loss 0.5055 acc 0.9515
Epoch 20/40 | Time 182.1s | Train loss 0.4083 acc 0.9834 | Val loss 0.4836 acc 0.9593
Epoch 21/40 | Time 180.9s | Train loss 0.4118 acc 0.9777 | Val loss 0.4684 acc 0.9515
Epoch 22/40 | Time 182.0s | Train loss 0.3542 acc 0.9912 | Val loss 0.4593 acc 0.9437
Epoch 23/40 | Time 180.9s | Train loss 0.3618 acc 0.9886 | Val loss 0.4536 acc 0.9593
Epoch 24/40 | Time 179.8s | Train loss 0.3442 acc 0.9886 | Val loss 0.4446 acc 0.9515
Epoch 25/40 | Time 180.2s | Train loss 0.3284 acc 0.9974 | Val loss 0.4364 acc 0.9593
Epoch 26/40 | Time 178.7s | Train loss 0.3237 acc 0.9922 | Val loss 0.4284 acc 0.9593
Epoch 27/40 | Time 179.1s | Train loss 0.3129 acc 0.9922 | Val loss 0.4211 acc 0.9515
Epoch 28/40 | Time 178.5s | Train loss 0.3017 acc 0.9974 | Val loss 0.4131 acc 0.9593
Epoch 29/40 | Time 179.6s | Train loss 0.3079 acc 0.9948 | Val loss 0.4065 acc 0.9593
Epoch 30/40 | Time 179.1s | Train loss 0.2897 acc 0.9948 | Val loss 0.4034 acc 0.9593
Epoch 31/40 | Time 181.2s | Train loss 0.2840 acc 0.9974 | Val loss 0.3993 acc 0.9593
Epoch 32/40 | Time 179.0s | Train loss 0.2829 acc 0.9948 | Val loss 0.3994 acc 0.9593
Epoch 33/40 | Time 179.5s | Train loss 0.2815 acc 0.9948 | Val loss 0.3967 acc 0.9593
Epoch 34/40 | Time 180.7s | Train loss 0.2800 acc 0.9964 | Val loss 0.3982 acc 0.9593
Epoch 35/40 | Time 179.7s | Train loss 0.2726 acc 0.9974 | Val loss 0.3925 acc 0.9593
Epoch 36/40 | Time 180.8s | Train loss 0.2711 acc 0.9974 | Val loss 0.3901 acc 0.9593
Epoch 37/40 | Time 181.0s | Train loss 0.2810 acc 0.9948 | Val loss 0.3906 acc 0.9593
Epoch 38/40 | Time 180.3s | Train loss 0.2649 acc 0.9964 | Val loss 0.3855 acc 0.9593
Epoch 39/40 | Time 180.9s | Train loss 0.2659 acc 0.9948 | Val loss 0.3831 acc 0.9593
Epoch 40/40 | Time 179.9s | Train loss 0.2737 acc 0.9948 | Val loss 0.3830 acc 0.9593
Training finished. Best val acc: 0.9593211263418198

Using device: cuda
Loading ResNet weights from checkpoints_batchsize32_and_no_reg/resnet18_finetune/train_full/best.pth
Custom ResNet weights loaded successfully.
Epoch 1/40 | Time 184.0s | Train loss 2.9647 acc 0.1166 | Val loss 2.9770 acc 0.0555
Epoch 2/40 | Time 180.0s | Train loss 2.8474 acc 0.2582 | Val loss 2.9310 acc 0.1837
Epoch 3/40 | Time 178.1s | Train loss 2.6931 acc 0.4748 | Val loss 2.8584 acc 0.1915
Epoch 4/40 | Time 180.0s | Train loss 2.4814 acc 0.6341 | Val loss 2.7279 acc 0.2400
Epoch 5/40 | Time 181.5s | Train loss 2.2097 acc 0.6475 | Val loss 2.5791 acc 0.3112
Epoch 6/40 | Time 178.7s | Train loss 1.9263 acc 0.7086 | Val loss 2.3953 acc 0.3925
Epoch 7/40 | Time 178.1s | Train loss 1.6443 acc 0.7403 | Val loss 2.0492 acc 0.5294
Epoch 8/40 | Time 178.4s | Train loss 1.4331 acc 0.7839 | Val loss 1.6393 acc 0.6670
Epoch 9/40 | Time 177.1s | Train loss 1.3155 acc 0.7861 | Val loss 1.3843 acc 0.7069
Epoch 10/40 | Time 178.0s | Train loss 1.2153 acc 0.8090 | Val loss 1.2533 acc 0.7530
Epoch 11/40 | Time 178.5s | Train loss 1.1125 acc 0.8423 | Val loss 1.1793 acc 0.7452
Epoch 12/40 | Time 177.6s | Train loss 1.0496 acc 0.8308 | Val loss 1.1173 acc 0.7702
Epoch 13/40 | Time 178.6s | Train loss 0.9245 acc 0.8625 | Val loss 1.0332 acc 0.7936
Epoch 14/40 | Time 177.6s | Train loss 0.8673 acc 0.8599 | Val loss 0.9812 acc 0.7608
Epoch 15/40 | Time 177.7s | Train loss 0.7962 acc 0.8636 | Val loss 0.9390 acc 0.8015
Epoch 16/40 | Time 177.3s | Train loss 0.7564 acc 0.9052 | Val loss 0.9129 acc 0.7936
Epoch 17/40 | Time 178.3s | Train loss 0.7317 acc 0.8896 | Val loss 0.8866 acc 0.8015
Epoch 18/40 | Time 179.6s | Train loss 0.7059 acc 0.9079 | Val loss 0.8573 acc 0.8171
Epoch 19/40 | Time 180.0s | Train loss 0.6853 acc 0.9042 | Val loss 0.8326 acc 0.8015
Epoch 20/40 | Time 180.8s | Train loss 0.6571 acc 0.9016 | Val loss 0.8036 acc 0.8093
Epoch 21/40 | Time 180.5s | Train loss 0.6369 acc 0.9120 | Val loss 0.7850 acc 0.8093
Epoch 22/40 | Time 182.1s | Train loss 0.6034 acc 0.9235 | Val loss 0.7730 acc 0.8093
Epoch 23/40 | Time 182.5s | Train loss 0.5770 acc 0.9344 | Val loss 0.7561 acc 0.8171
Epoch 24/40 | Time 178.1s | Train loss 0.5866 acc 0.9329 | Val loss 0.7441 acc 0.8015
Epoch 25/40 | Time 177.8s | Train loss 0.5788 acc 0.9329 | Val loss 0.7402 acc 0.8171
Epoch 26/40 | Time 178.7s | Train loss 0.5622 acc 0.9375 | Val loss 0.7308 acc 0.8171
Epoch 27/40 | Time 179.2s | Train loss 0.5572 acc 0.9391 | Val loss 0.7222 acc 0.8257
Epoch 28/40 | Time 179.0s | Train loss 0.5487 acc 0.9355 | Val loss 0.7099 acc 0.8499
Epoch 29/40 | Time 181.3s | Train loss 0.5232 acc 0.9433 | Val loss 0.7082 acc 0.8249
Epoch 30/40 | Time 178.2s | Train loss 0.5277 acc 0.9339 | Val loss 0.7014 acc 0.8570
Epoch 31/40 | Time 178.2s | Train loss 0.5151 acc 0.9479 | Val loss 0.6913 acc 0.8499
Epoch 32/40 | Time 177.7s | Train loss 0.5238 acc 0.9292 | Val loss 0.6890 acc 0.8656
Epoch 33/40 | Time 177.9s | Train loss 0.5100 acc 0.9433 | Val loss 0.6848 acc 0.8734
Epoch 34/40 | Time 179.3s | Train loss 0.5013 acc 0.9433 | Val loss 0.6827 acc 0.8499
Epoch 35/40 | Time 178.9s | Train loss 0.4992 acc 0.9443 | Val loss 0.6777 acc 0.8499
Epoch 36/40 | Time 177.9s | Train loss 0.5014 acc 0.9443 | Val loss 0.6773 acc 0.8578
Epoch 37/40 | Time 178.1s | Train loss 0.4976 acc 0.9485 | Val loss 0.6739 acc 0.8578
Epoch 38/40 | Time 179.4s | Train loss 0.4823 acc 0.9443 | Val loss 0.6728 acc 0.8656
Epoch 39/40 | Time 179.9s | Train loss 0.5031 acc 0.9386 | Val loss 0.6733 acc 0.8656
Epoch 40/40 | Time 179.4s | Train loss 0.4933 acc 0.9547 | Val loss 0.6689 acc 0.8578
Training finished. Best val acc: 0.8733836263418198

Using device: cuda
Loaded checkpoint from epoch 40
Warning: Optimizer state has different number of parameter groups (likely due to unfreezing backbone). Skipping optimizer state loading.
Epoch 41/60 | Time 191.6s | Train loss 0.3305 acc 0.9723
Epoch 42/60 | Time 190.9s | Train loss 0.2168 acc 0.9930
Epoch 43/60 | Time 183.7s | Train loss 0.1352 acc 0.9980
Epoch 44/60 | Time 183.7s | Train loss 0.0964 acc 0.9969
Epoch 45/60 | Time 186.3s | Train loss 0.0764 acc 0.9980
Epoch 46/60 | Time 188.3s | Train loss 0.0635 acc 0.9980
Epoch 47/60 | Time 186.7s | Train loss 0.0573 acc 1.0000
Epoch 48/60 | Time 187.4s | Train loss 0.0441 acc 0.9980
Epoch 49/60 | Time 187.7s | Train loss 0.0356 acc 1.0000
Epoch 50/60 | Time 186.2s | Train loss 0.0331 acc 1.0000
Epoch 51/60 | Time 185.9s | Train loss 0.0308 acc 1.0000
Epoch 52/60 | Time 186.8s | Train loss 0.0266 acc 1.0000
Epoch 53/60 | Time 183.1s | Train loss 0.0260 acc 1.0000
Epoch 54/60 | Time 190.1s | Train loss 0.0230 acc 1.0000
Epoch 55/60 | Time 190.9s | Train loss 0.0211 acc 1.0000
Epoch 56/60 | Time 188.4s | Train loss 0.0198 acc 1.0000
Epoch 57/60 | Time 189.1s | Train loss 0.0188 acc 1.0000
Epoch 58/60 | Time 188.7s | Train loss 0.0189 acc 1.0000
Epoch 59/60 | Time 186.6s | Train loss 0.0180 acc 1.0000
Epoch 60/60 | Time 186.8s | Train loss 0.0165 acc 1.0000
Resume training finished. Best train loss: 0.01647493604104966

Using device: cuda
Loaded checkpoint from epoch 40
Optimizer state loaded successfully.
Epoch 41/60 | Time 190.2s | Train loss 0.0801 acc 1.0000
Epoch 42/60 | Time 185.8s | Train loss 0.0772 acc 0.9969
Epoch 43/60 | Time 184.5s | Train loss 0.0720 acc 1.0000
Epoch 44/60 | Time 185.0s | Train loss 0.0731 acc 1.0000
Epoch 45/60 | Time 190.1s | Train loss 0.0667 acc 1.0000
Epoch 46/60 | Time 189.2s | Train loss 0.0704 acc 1.0000
Epoch 47/60 | Time 191.4s | Train loss 0.0718 acc 1.0000
Epoch 48/60 | Time 188.7s | Train loss 0.0656 acc 1.0000
Epoch 49/60 | Time 187.0s | Train loss 0.0661 acc 1.0000
Epoch 50/60 | Time 190.4s | Train loss 0.0676 acc 1.0000
Epoch 51/60 | Time 187.4s | Train loss 0.0654 acc 1.0000
Epoch 52/60 | Time 186.9s | Train loss 0.0610 acc 1.0000
Epoch 53/60 | Time 184.7s | Train loss 0.0615 acc 1.0000
Epoch 54/60 | Time 183.7s | Train loss 0.0633 acc 1.0000
Epoch 55/60 | Time 184.5s | Train loss 0.0605 acc 1.0000
Epoch 56/60 | Time 184.3s | Train loss 0.0607 acc 1.0000
Epoch 57/60 | Time 184.9s | Train loss 0.0641 acc 1.0000
Epoch 58/60 | Time 183.3s | Train loss 0.0601 acc 1.0000
Epoch 59/60 | Time 183.9s | Train loss 0.0627 acc 1.0000
Epoch 60/60 | Time 182.8s | Train loss 0.0575 acc 1.0000
Resume training finished. Best train loss: 0.057495471090078354

Using device: cuda
Loading ResNet weights from /root/autodl-tmp/checkpoints_batchsize32_and_no_reg/resnet18_finetune/train_full/best.pth
Custom ResNet weights loaded successfully.
Loading ResNet weights from /root/autodl-tmp/checkpoints_batchsize32_and_no_reg/infrared_finetune/train_full_and_resnet18_finetune/best.pth
Custom ResNet weights loaded successfully.
Epoch 1/30 | Time 183.5s | Train loss 2.9202 acc 0.1227
Epoch 2/30 | Time 181.2s | Train loss 2.7185 acc 0.4078
Epoch 3/30 | Time 180.5s | Train loss 2.4666 acc 0.5691
Epoch 4/30 | Time 178.5s | Train loss 2.1507 acc 0.6363
Epoch 5/30 | Time 178.3s | Train loss 1.8448 acc 0.7031
Epoch 6/30 | Time 178.5s | Train loss 1.5092 acc 0.7805
Epoch 7/30 | Time 180.2s | Train loss 1.2495 acc 0.8477
Epoch 8/30 | Time 179.0s | Train loss 1.0649 acc 0.8777
Epoch 9/30 | Time 178.9s | Train loss 0.9606 acc 0.8781
Epoch 10/30 | Time 178.0s | Train loss 0.8745 acc 0.8957
Epoch 11/30 | Time 178.0s | Train loss 0.7759 acc 0.9129
Epoch 12/30 | Time 177.8s | Train loss 0.7086 acc 0.9156
Epoch 13/30 | Time 180.6s | Train loss 0.6434 acc 0.9375
Epoch 14/30 | Time 179.1s | Train loss 0.5893 acc 0.9352
Epoch 15/30 | Time 180.8s | Train loss 0.5641 acc 0.9531
Epoch 16/30 | Time 179.2s | Train loss 0.5108 acc 0.9566
Epoch 17/30 | Time 181.0s | Train loss 0.4881 acc 0.9492
Epoch 18/30 | Time 180.6s | Train loss 0.4787 acc 0.9539
Epoch 19/30 | Time 177.8s | Train loss 0.4342 acc 0.9605
Epoch 20/30 | Time 179.0s | Train loss 0.4245 acc 0.9559
Epoch 21/30 | Time 178.4s | Train loss 0.4122 acc 0.9598
Epoch 22/30 | Time 179.3s | Train loss 0.4102 acc 0.9648
Epoch 23/30 | Time 180.1s | Train loss 0.3932 acc 0.9664
Epoch 24/30 | Time 180.7s | Train loss 0.3940 acc 0.9715
Epoch 25/30 | Time 180.1s | Train loss 0.3732 acc 0.9656
Epoch 26/30 | Time 180.5s | Train loss 0.3547 acc 0.9688
Epoch 27/30 | Time 180.7s | Train loss 0.3501 acc 0.9746
Epoch 28/30 | Time 182.6s | Train loss 0.3499 acc 0.9707
Epoch 29/30 | Time 187.4s | Train loss 0.3389 acc 0.9668
Epoch 30/30 | Time 184.6s | Train loss 0.3364 acc 0.9766
Training finished. Best train loss: 0.3364197416231036

Using device: cuda
Loading ResNet weights from /root/autodl-tmp/checkpoints_batchsize32_and_no_reg/resnet18_finetune/train_full/best.pth
Custom ResNet weights loaded successfully.
Loading ResNet weights from /root/autodl-tmp/checkpoints_batchsize32_and_no_reg/infrared_finetune/train_full_and_resnet18_finetune/best.pth
Custom ResNet weights loaded successfully.
Epoch 1/30 | Time 184.6s | Train loss 2.9363 acc 0.1316
Epoch 2/30 | Time 181.2s | Train loss 2.7260 acc 0.4137
Epoch 3/30 | Time 180.9s | Train loss 2.4627 acc 0.5508
Epoch 4/30 | Time 180.4s | Train loss 2.1380 acc 0.6555
Epoch 5/30 | Time 178.6s | Train loss 1.8175 acc 0.7320
Epoch 6/30 | Time 179.9s | Train loss 1.5278 acc 0.7785
Epoch 7/30 | Time 178.7s | Train loss 1.2700 acc 0.8336
Epoch 8/30 | Time 179.7s | Train loss 1.0795 acc 0.8574
Epoch 9/30 | Time 179.4s | Train loss 0.9955 acc 0.8797
Epoch 10/30 | Time 179.2s | Train loss 0.8869 acc 0.9008
Epoch 11/30 | Time 180.4s | Train loss 0.8128 acc 0.9227
Epoch 12/30 | Time 180.5s | Train loss 0.7292 acc 0.9156
Epoch 13/30 | Time 179.9s | Train loss 0.6739 acc 0.9363
Epoch 14/30 | Time 179.9s | Train loss 0.6091 acc 0.9469
Epoch 15/30 | Time 180.1s | Train loss 0.5797 acc 0.9410
Epoch 16/30 | Time 178.7s | Train loss 0.5273 acc 0.9473
Epoch 17/30 | Time 178.5s | Train loss 0.4853 acc 0.9590
Epoch 18/30 | Time 179.0s | Train loss 0.4846 acc 0.9617
Epoch 19/30 | Time 179.0s | Train loss 0.4625 acc 0.9535
Epoch 20/30 | Time 179.2s | Train loss 0.4537 acc 0.9645
Epoch 21/30 | Time 180.2s | Train loss 0.4085 acc 0.9668
Epoch 22/30 | Time 178.7s | Train loss 0.4135 acc 0.9676
Epoch 23/30 | Time 180.1s | Train loss 0.4025 acc 0.9598
Epoch 24/30 | Time 184.2s | Train loss 0.3929 acc 0.9688
Epoch 25/30 | Time 184.7s | Train loss 0.3985 acc 0.9746
Epoch 26/30 | Time 183.5s | Train loss 0.3780 acc 0.9746
Epoch 27/30 | Time 181.3s | Train loss 0.3819 acc 0.9727
Epoch 28/30 | Time 183.2s | Train loss 0.3637 acc 0.9723
Epoch 29/30 | Time 183.8s | Train loss 0.3571 acc 0.9746
Epoch 30/30 | Time 181.8s | Train loss 0.3582 acc 0.9727
Training finished. Best train loss: 0.35705300606787205

Using device: cuda
Loaded checkpoint from epoch 30
Warning: Optimizer state has different number of parameter groups (likely due to unfreezing backbone). Skipping optimizer state loading.
Epoch 31/50 | Time 140.0s | Train loss 0.4304 acc 0.9473
Epoch 32/50 | Time 138.3s | Train loss 0.3217 acc 0.9746
Epoch 33/50 | Time 140.0s | Train loss 0.2307 acc 0.9688
Epoch 34/50 | Time 139.7s | Train loss 0.1730 acc 0.9902
Epoch 35/50 | Time 139.1s | Train loss 0.1365 acc 0.9922
Epoch 36/50 | Time 138.6s | Train loss 0.0800 acc 0.9961
Epoch 37/50 | Time 137.6s | Train loss 0.0637 acc 0.9941
Epoch 38/50 | Time 139.1s | Train loss 0.0539 acc 0.9980
Epoch 39/50 | Time 138.4s | Train loss 0.0417 acc 1.0000
Epoch 40/50 | Time 138.2s | Train loss 0.0494 acc 0.9961
Epoch 41/50 | Time 139.2s | Train loss 0.0325 acc 1.0000
Epoch 42/50 | Time 138.1s | Train loss 0.0292 acc 0.9980
Epoch 43/50 | Time 138.9s | Train loss 0.0241 acc 1.0000
Epoch 44/50 | Time 138.3s | Train loss 0.0225 acc 1.0000
Epoch 45/50 | Time 138.7s | Train loss 0.0218 acc 1.0000
Epoch 46/50 | Time 137.6s | Train loss 0.0204 acc 1.0000
Epoch 47/50 | Time 139.5s | Train loss 0.0157 acc 1.0000
Epoch 48/50 | Time 135.3s | Train loss 0.0310 acc 0.9922
Epoch 49/50 | Time 135.8s | Train loss 0.0180 acc 1.0000
Epoch 50/50 | Time 140.1s | Train loss 0.0159 acc 1.0000
Resume training finished. Best train loss: 0.01570360641926527

Using device: cuda
Loaded checkpoint from epoch 29
Warning: Optimizer state has different number of parameter groups (likely due to unfreezing backbone). Skipping optimizer state loading.
Epoch 30/50 | Time 142.2s | Train loss 0.4926 acc 0.9473
Epoch 31/50 | Time 140.5s | Train loss 0.3459 acc 0.9668
Epoch 32/50 | Time 137.8s | Train loss 0.2373 acc 0.9883
Epoch 33/50 | Time 137.7s | Train loss 0.2018 acc 0.9844
Epoch 34/50 | Time 136.9s | Train loss 0.1201 acc 0.9961
Epoch 35/50 | Time 137.0s | Train loss 0.0963 acc 0.9941
Epoch 36/50 | Time 136.0s | Train loss 0.0603 acc 0.9980
Epoch 37/50 | Time 137.3s | Train loss 0.0517 acc 0.9980
Epoch 38/50 | Time 139.3s | Train loss 0.0434 acc 1.0000
Epoch 39/50 | Time 137.4s | Train loss 0.0434 acc 0.9980
Epoch 40/50 | Time 137.6s | Train loss 0.0285 acc 0.9980
Epoch 41/50 | Time 137.9s | Train loss 0.0276 acc 1.0000
Epoch 42/50 | Time 135.6s | Train loss 0.0219 acc 1.0000
Epoch 43/50 | Time 137.8s | Train loss 0.0538 acc 0.9844
Epoch 44/50 | Time 136.0s | Train loss 0.0194 acc 1.0000
Epoch 45/50 | Time 137.2s | Train loss 0.0244 acc 0.9980
Epoch 46/50 | Time 137.6s | Train loss 0.0183 acc 1.0000
Epoch 47/50 | Time 137.2s | Train loss 0.0191 acc 1.0000
Epoch 48/50 | Time 137.0s | Train loss 0.0149 acc 1.0000
Epoch 49/50 | Time 135.9s | Train loss 0.0180 acc 1.0000
Epoch 50/50 | Time 131.4s | Train loss 0.0131 acc 1.0000
Resume training finished. Best train loss: 0.013100589814712293

